print("=== DCNv2 ë…¼ë¬¸ ë¶„ì„ ===")
print()

print("ğŸ“– **DCNv2 ë…¼ë¬¸ì˜ í•µì‹¬ êµ¬ì¡°:**")
print("1. **Cross Network**:")
print("   - ìˆ˜ì‹: x_{l+1} = x_0 * x_l^T * w_l + x_l + b_l")
print("   - ëª©ì : ëª…ì‹œì  íŠ¹ì„± êµì°¨ í•™ìŠµ")
print("   - íŒŒë¼ë¯¸í„°: w_l (input_dim x input_dim)")
print()

print("2. **Low-rank Factorization (DCNv2ì˜ í•µì‹¬)**:")
print("   - ìˆ˜ì‹: w_l = U_l * V_l^T")
print("   - U_l: (input_dim x low_rank)")
print("   - V_l: (input_dim x low_rank)")
print("   - ëª©ì : íŒŒë¼ë¯¸í„° ìˆ˜ ê°ì†Œ (input_dim^2 â†’ 2*input_dim*low_rank)")
print()

print("3. **Deep Network**:")
print("   - í‘œì¤€ MLP êµ¬ì¡°")
print("   - ReLU + Dropout")
print()

print("4. **Combination Layer**:")
print("   - Cross Network ì¶œë ¥ + Deep Network ì¶œë ¥")
print("   - ìµœì¢… ë¶„ë¥˜/íšŒê·€ ë ˆì´ì–´")
print()

print("ğŸ” **í˜„ì¬ êµ¬í˜„ì˜ ë¬¸ì œì :**")
print("1. **Cross Network êµ¬í˜„**:")
print("   - í˜„ì¬: U_out * V_outì˜ sumì„ ê³„ì‚°")
print("   - ë¬¸ì œ: ë…¼ë¬¸ê³¼ ë‹¤ë¥¸ êµ¬ì¡°")
print("   - ìˆ˜ì • í•„ìš”: x_0 * (U_out * V_out^T) * x_l í˜•íƒœë¡œ ë³€ê²½")
print()

print("2. **Low-rank ê³„ì‚°**:")
print("   - í˜„ì¬: torch.sum(U_out * V_out, dim=1, keepdim=True)")
print("   - ë¬¸ì œ: ìŠ¤ì¹¼ë¼ ê°’ì´ ë‚˜ì˜´")
print("   - ìˆ˜ì • í•„ìš”: í–‰ë ¬ ê³±ì…ˆìœ¼ë¡œ ë³€ê²½")
print()

print("3. **Forward Pass**:")
print("   - í˜„ì¬: ë³µì¡í•œ ì¡°í•©")
print("   - ìˆ˜ì • í•„ìš”: ë…¼ë¬¸ê³¼ ë™ì¼í•œ êµ¬ì¡°ë¡œ ë‹¨ìˆœí™”")
print()

print("ğŸ¯ **ìˆ˜ì • ë°©í–¥:**")
print("1. Cross Networkë¥¼ ë…¼ë¬¸ê³¼ ë™ì¼í•˜ê²Œ êµ¬í˜„")
print("2. Low-rank factorizationì„ ì •í™•íˆ êµ¬í˜„")
print("3. Deep Networkë¥¼ ë‹¨ìˆœí™”")
print("4. Combination layerë¥¼ ë…¼ë¬¸ê³¼ ë™ì¼í•˜ê²Œ êµ¬í˜„")
print()

print("ğŸ“ **êµ¬í˜„í•  êµ¬ì¡°:**")
print("Cross Network:")
print("  x_0 = input")
print("  for l in range(num_layers):")
print("    U_l = Linear(input_dim, low_rank)")
print("    V_l = Linear(input_dim, low_rank)")
print("    xw = x_0 * (U_l(x) * V_l(x)^T)")
print("    x_{l+1} = xw + x_l")
print()

print("Deep Network:")
print("  MLP with ReLU + Dropout")
print()

print("Combination:")
print("  output = Linear(cross_output + deep_output)") 